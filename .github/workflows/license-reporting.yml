name: License Reporting

on:
  push:
    paths:
      - 'requirements.txt'
      - '.github/workflows/license-reporting.yml'

env:
  PYTHON_KEYRING_BACKEND: keyring.backends.null.Keyring
  IGNORE_LICENSES: "MIT License;Apache Software License;BSD License;Mozilla Public License 2.0 (MPL 2.0)"
  # IGNORE_PACKAGES: "astroid;chardet;crytic-compile"

jobs:
  scan:
    name: Scan for licenses
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-python@v4
        with:
          python-version: "3.10"
      - name: Install pip-licenses
        run: pip3 install pip-licenses
      - name: Scan for licenses
        run: pip-licenses --allow-only="{{ $IGNORE_LICENSES }}" # --ignore-packages="{{ $IGNORE_PACKAGES }}"
